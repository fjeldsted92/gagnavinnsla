import pandas as pd
import matplotlib.pyplot as plt

frames = []
files =['WI.csv','CPI.csv','Housing.csv']

#les gögn úr mörgum skjölum inn í 1 DataFrame.
#Gögnin verða að vera á formatinu 'Year' 'Month' 'Data', raðað eftir dálkum
for f in files:
    frames.append(pd.read_csv(f, engine='python',na_values = ['.','...'],index_col = [0,1]))
result=pd.concat(frames, axis = 1, join='outer')
t = result.rename(columns={'Indices': 'Wages'})    #Notað til að skýra dálka upp á nýtt, býr til nýjan dataframe
t.rename(columns={'Consumer price index less housing cost Index' : 'CPILH'}, inplace = True) #Skýrir dálkinn upp á nýtt, býr ekki til nýjan
t.rename(columns={'Consumer price index Index' : 'CPI'}, inplace = True)
t.rename(columns={'multi-flat, capital area' : 'Rvk fjol'}, inplace = True)
t.rename(columns={'Capital area' : 'Rvk'}, inplace = True)
t.rename(columns={'single-flat houses, outside capital' : 'Dreifbyli, einb'}, inplace = True)
col_len = len(t.columns)

t = t.dropna()            #droppum línum með NaN


#N: MoM_pct_change(pd.DataFrame.columns a,  int b)
#F: a is columns of pandas dataframe t, b is number of columns in a to be operated on
#E: creates new columns in t with 1-period percentage changes, with _MoM appended to name.
def MoM_pct_change(a,b):
    for i in a[0:b]:
        t[i+'_MoM']=t[i].pct_change()
    return

MoM_pct_change(t.columns,col_len)

#N: YoY_pct_change(pd.DataFrame.columns a, int b)
#F: a is columns of pandas dataframe t, b is number of columns in a to be operated on
#E: creates new columns in t with 12-period percentage changes, with _YoY appended to name.
def YoY_pct_change(a,b):
    for i in a[0:b]:
        t[i+'_YoY']=t[i].pct_change(periods=12)
    return

YoY_pct_change(t.columns,col_len)

#N: cum_ind_change(pd.DataFrame.columns a, int b)
#F: a is columns of pandas dataframe t, b is number of columns in a to be operated on
#E: creates new columns in t with the total difference between t[i][j] and t[i][0],which for index is total change compared to a new baseline t[i][0]
def cum_ind_change(a,b):
    for i in a[0:b]:
         t[i+'_total_change']=t[i]-t[i][0]
    return

cum_ind_change(t.columns,col_len)

monthly_Corr = pd.DataFrame(t.ix[:,'Wages_MoM':'total_MoM'])
print(monthly_Corr.corr())

yearly_Corr =  pd.DataFrame(t.ix[:,'Wages_YoY':'total_YoY'])
print(yearly_Corr.corr())

total_Corr = pd.DataFrame(t.ix[:,'Wages_total_change':'total_total_change'])
print(total_Corr.corr())


print('-------------------------------------------')
plt.figure()
plt.subplot(2,1,1)
mynd1_1 = t['Wages_total_change'].plot()
mynd1_2 = t['CPI_total_change'].plot()
mynd1_3 = t['CPILH_total_change'].plot()
plt.legend(loc='upper left')
plt.subplot(2,1,2)
mynd1_4 = t['Rvk_total_change'].plot()
mynd1_5 = t['Rvk fjol_total_change'].plot()
mynd61_6 = t['Dreifbyli, einb_total_change'].plot()

plt.legend(loc='upper left')
plt.show()

plt.figure()
mynd2_1 = t['Wages_MoM'].plot()
mynd2_2 = t['CPI_MoM'].plot()
mynd2_3 = t['CPILH_MoM'].plot()

plt.legend(loc='upper left')
plt.show()
